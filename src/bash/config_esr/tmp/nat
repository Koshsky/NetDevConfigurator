<nat_dest>
nat destination
  pool HP
    ip address 10.3.0.250
  exit
  pool CONF
    ip address 10.10.10.10
  exit
  <nat_dest_tc>
  pool TR_Conf
    ip address 10.10.10.11
  exit
  <@nat_dest_tc>
  pool STREAM_1
    ip address 10.3.0.11
  exit
  <nat_dest_ph>
  pool PH_1
    ip address 10.2.0.111
    ip port 3316
  exit
  <@nat_dest_ph>
  <nat_dest_tcroom>
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  pool TRCONF_ROOM3
    ip address 10.3.3.10
    ip port 80
  exit
  pool TRCONF_ROOM4
    ip address 10.3.4.10
    ip port 80
  exit
  pool TRCONF_ROOM5
    ip address 10.3.5.10
    ip port 80
  exit
  pool TRCONF_ROOM6
    ip address 10.3.6.10
    ip port 80
  exit
  pool TRCONF_ROOM7
    ip address 10.3.7.10
    ip port 80
  exit
  pool TRCONF_ROOM8
    ip address 10.3.8.10
    ip port 80
  exit
  pool TRCONF_ROOM9
    ip address 10.3.9.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM1
    ip address 10.3.1.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  pool TRCONF_ROOM2
    ip address 10.3.2.10
    ip port 80
  exit
  <@nat_dest_tcroom>
  <nat_dest_raisa>
  pool RAISA
    ip address 10.5.0.10
  exit
  <@nat_dest_raisa>
  ruleset DNAT
    from zone untrusted
    rule 1
      match protocol tcp
      match destination-address Public_IP
      match destination-port https
      action destination-nat pool HP
      enable
    exit
    rule 2
      match protocol tcp
      match destination-address Public_IP
      match destination-port HP_https
      action destination-nat pool HP
      enable
    exit
    rule 3
      match protocol tcp
      match destination-address Public_IP
      match destination-port DMZ_stream
      action destination-nat pool CONF
      enable
    exit
    <nat_dest_tc>
    rule 5
      match protocol tcp
      match destination-address Public_IP
      match destination-port http
      action destination-nat pool TR_Conf
      enable
    exit
    <@nat_dest_tc>
    rule 10
      match protocol tcp
      match destination-address Public_IP
      match destination-port KMS
      action destination-nat pool CONF
      enable
    exit
    <nat_dest_tc>
    rule 11
      match protocol tcp
      match destination-address Public_IP
      match destination-port trueconf
      action destination-nat pool TR_Conf
      enable
    exit
    rule 12
      match protocol tcp
      match destination-address Public_IP
      match destination-port SIP
      action destination-nat pool TR_Conf
      enable
    exit
    rule 13
      match protocol udp
      match destination-address Public_IP
      match destination-port SIP
      action destination-nat pool TR_Conf
      enable
    exit
    rule 14
      match protocol tcp
      match destination-address Public_IP
      match destination-port H323
      action destination-nat pool TR_Conf
      enable
    exit
    rule 15
      match protocol udp
      match destination-address Public_IP
      match destination-port H323
      action destination-nat pool TR_Conf
      enable
    exit
    <@nat_dest_tc>
    rule 20
      match protocol udp
      match destination-address Public_IP
      match destination-port WRTC
      action destination-nat pool CONF
      enable
    exit
    <nat_dest_tc>
    rule 21
      match protocol udp
      match destination-address Public_IP
      match destination-port RTP
      action destination-nat pool TR_Conf
      enable
    exit
    rule 22
      match protocol tcp
      match destination-address Public_IP
      match destination-port WRTC_TrConf
      action destination-nat pool TR_Conf
      enable
    exit
    rule 23
      match protocol udp
      match destination-address Public_IP
      match destination-port WRTC_TrConf
      action destination-nat pool TR_Conf
      enable
    exit
    <@nat_dest_tc>
    rule 30
      match protocol tcp
      match destination-address Public_IP
      match destination-port extconf
      action destination-nat pool CONF
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address Public_IP
      match destination-port Streamer_service1
      action destination-nat pool STREAM_1
      enable
    exit
    <nat_dest_tcroom>
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 43
      match protocol tcp
      match destination-address TCRoom3_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM3
      enable
    exit
    rule 44
      match protocol tcp
      match destination-address TCRoom4_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM4
      enable
    exit
    rule 45
      match protocol tcp
      match destination-address TCRoom5_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM5
      enable
    exit
    rule 46
      match protocol tcp
      match destination-address TCRoom6_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM6
      enable
    exit
    rule 47
      match protocol tcp
      match destination-address TCRoom7_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM7
      enable
    exit
    rule 48
      match protocol tcp
      match destination-address TCRoom8_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM8
      enable
    exit
    rule 49
      match protocol tcp
      match destination-address TCRoom9_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM9
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 41
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 42
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port tc_room
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 53
      match protocol tcp
      match destination-address TCRoom3_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM3
      enable
    exit
    rule 54
      match protocol tcp
      match destination-address TCRoom4_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM4
      enable
    exit
    rule 55
      match protocol tcp
      match destination-address TCRoom5_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM5
      enable
    exit
    rule 56
      match protocol tcp
      match destination-address TCRoom6_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM6
      enable
    exit
    rule 57
      match protocol tcp
      match destination-address TCRoom7_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM7
      enable
    exit
    rule 58
      match protocol tcp
      match destination-address TCRoom8_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM8
      enable
    exit
    rule 59
      match protocol tcp
      match destination-address TCRoom9_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM9
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 51
      match protocol tcp
      match destination-address TCRoom1_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM1
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    rule 52
      match protocol tcp
      match destination-address TCRoom2_Public_IP
      match destination-port rdp
      action destination-nat pool TRCONF_ROOM2
      enable
    exit
    <@nat_dest_tcroom>
    <nat_dest_ph>
    rule 61
      match protocol tcp
      match destination-address Public_IP
      match destination-port ph_nat1
      action destination-nat pool PH_1
      enable
    exit
    <@nat_dest_ph>
    <nat_dest_raisa>
    rule 70
      match protocol tcp
      match destination-address RAISA_Public_IP
      match destination-port http
      action destination-nat pool RAISA
      enable
    exit
    <@nat_dest_raisa>
  exit
  ruleset INT_DNAT
    from zone trusted
    rule 1
      match protocol tcp
      match destination-address Public_IP
      match destination-port KMS
      action destination-nat pool CONF
      enable
    exit
    rule 10
      match protocol udp
      match destination-address Public_IP
      match destination-port WRTC
      action destination-nat pool CONF
      enable
    exit
  exit
exit
<@nat_dest>

<nat_source>
nat source
  pool esr_ext
    ip address-range <pub_ip>
  exit
  <nat_source_raisa>
  pool raisa_ext
    ip address-range <raisa_ip>
  exit
  <@nat_source_raisa>
  ruleset SNAT
    to interface bridge 1
    rule 1
      match source-address INT_NET
      action source-nat pool esr_ext
      enable
    exit
    rule 2
      match source-address DMZ_NET
      action source-nat pool esr_ext
      enable
    exit
    <nat_source_raisa>
    rule 3
      match source-address RAISA_NET
      action source-nat pool raisa_ext
      enable
    exit
    <@nat_source_raisa>
  exit
exit
<@nat_source>
